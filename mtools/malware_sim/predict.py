# %%
from gensim.models.doc2vec import Doc2Vec
import os

# %%
from .scripts.transform import get_opcode_from

# %%
model_path = os.path.join(os.path.dirname(__file__), "trained_models/malware_sim%doc2vec.pth")
model = Doc2Vec.load(model_path)

# %%
def predict(bytes_path):
    ops = get_opcode_from(bytes_path)
    return model.infer_vector(ops).tolist()

